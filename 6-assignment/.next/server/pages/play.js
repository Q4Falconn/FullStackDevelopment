"use strict";(()=>{var e={};e.id=141,e.ids=[141,660],e.modules={9703:(e,r,t)=>{t.a(e,async(e,s)=>{try{t.r(r),t.d(r,{config:()=>m,default:()=>u,getServerSideProps:()=>g,getStaticPaths:()=>x,getStaticProps:()=>h,reportWebVitals:()=>y,routeModule:()=>P,unstable_getServerProps:()=>S,unstable_getServerSideProps:()=>b,unstable_getStaticParams:()=>v,unstable_getStaticPaths:()=>f,unstable_getStaticProps:()=>j});var a=t(7093),i=t(5244),n=t(1323),l=t(2899),o=t.n(l),c=t(6814),d=t(5383),p=e([c,d]);[c,d]=p.then?(await p)():p;let u=(0,n.l)(d,"default"),h=(0,n.l)(d,"getStaticProps"),x=(0,n.l)(d,"getStaticPaths"),g=(0,n.l)(d,"getServerSideProps"),m=(0,n.l)(d,"config"),y=(0,n.l)(d,"reportWebVitals"),j=(0,n.l)(d,"unstable_getStaticProps"),f=(0,n.l)(d,"unstable_getStaticPaths"),v=(0,n.l)(d,"unstable_getStaticParams"),S=(0,n.l)(d,"unstable_getServerProps"),b=(0,n.l)(d,"unstable_getServerSideProps"),P=new a.PagesRouteModule({definition:{kind:i.x.PAGES,page:"/play",pathname:"/play",bundlePath:"",filename:""},components:{App:c.default,Document:o()},userland:d});s()}catch(e){s(e)}})},5383:(e,r,t)=>{t.a(e,async(e,s)=>{try{t.r(r),t.d(r,{default:()=>x,getServerSideProps:()=>g});var a=t(997),i=t(6689),n=t(1163),l=t(2008),o=t(394),c=t(9865),d=t(2127),p=t(1902),u=t(5021),h=e([l,o]);function x(){let e=(0,l.T)(),r=(0,n.useRouter)(),t=(0,l.C)(e=>e.lobby.currentGameId),s=(0,l.C)(e=>e.game.serverGame),h=(0,l.C)(e=>e.auth.user?.username),x=(0,i.useMemo)(()=>{let e=s?.state;if(!e)return null;try{return(0,c.a1)(e).state}catch(e){return console.error(e),null}},[s?.state]),g=x?.currentRound,m=x?.players??[],y=x?.scores??[];if((0,i.useMemo)(()=>{if(x){for(let e=0;e<x.scores.length;e++)if(x.scores[e]>=x.targetScore)return e}},[x]),!t)return(0,a.jsxs)("div",{children:[a.jsx("p",{children:"No game selected. Go back to Setup."}),a.jsx("button",{onClick:()=>r.push("/"),children:"Go to Setup"})]});if(!s)return a.jsx("p",{children:"Loading game…"});if("WAITING"===s.status)return(0,a.jsxs)("div",{children:[a.jsx("h2",{children:"Waiting room"}),(0,a.jsxs)("p",{children:["Game: ",a.jsx("b",{children:t})]}),(0,a.jsxs)("p",{children:["Players: ",s.players.map(e=>e.username).join(", ")," (",s.players.length,"/",s.amountOfPlayers,")"]}),a.jsx("button",{onClick:()=>e((0,o.t)({gameId:t})),disabled:s.players.length<2,children:"Start game"})]});if(!g)return a.jsx("p",{children:"Game started, waiting for state…"});let j=h?m.indexOf(h):0,f=d.$m(g,j),v=g.discardPile[0],S=g.playerInTurn,b=S===j;async function P(r,s){let a;if(b&&d.tW(g,r)){if(("WILD"===s.type||"WILD DRAW"===s.type)&&!(a=function(){let e=window.prompt("Choose color: RED, GREEN, BLUE, YELLOW")?.trim().toUpperCase();if(e&&("RED"===e||"GREEN"===e||"BLUE"===e||"YELLOW"===e))return e}()))return;await e((0,o.Oq)({gameId:t,cardIndex:r,nextColor:a})).unwrap()}}return(0,a.jsxs)("div",{children:[a.jsx("h2",{children:"Play"}),(0,a.jsxs)("p",{style:{opacity:.8},children:["Game: ",a.jsx("b",{children:t})," \xb7 Current color: ",a.jsx("b",{children:g.currentColor})]}),(0,a.jsxs)("p",{children:["Turn: ",a.jsx("b",{children:m[S??0]??"—"})," ",b?"(you)":""]}),(0,a.jsxs)("div",{style:{display:"flex",gap:20,alignItems:"center",flexWrap:"wrap"},children:[(0,a.jsxs)("div",{children:[a.jsx("div",{style:{fontWeight:700,marginBottom:8},children:"Draw pile"}),a.jsx("div",{onClick:()=>b?e((0,o.tv)({gameId:t})):null,style:{cursor:b?"pointer":"not-allowed"},children:a.jsx(p.Z,{type:"DRAW"})}),a.jsx("div",{style:{opacity:.7,marginTop:6},children:b?"Click to draw":"Wait your turn"})]}),(0,a.jsxs)("div",{children:[a.jsx("div",{style:{fontWeight:700,marginBottom:8},children:"Discard pile"}),a.jsx(p.Z,{type:"DISCARD",card:v})]})]}),(0,a.jsxs)("h3",{style:{marginTop:22},children:["Your hand (",f.length,")"]}),!b&&a.jsx("p",{style:{opacity:.7},children:"You can’t play right now."}),a.jsx("div",{className:"cardGrid",children:f.map((e,r)=>{let t=b&&d.tW(g,r);return a.jsx("div",{onClick:()=>t&&P(r,e),style:{cursor:t?"pointer":"not-allowed",opacity:t?1:.45,transform:t?"translateY(-2px)":void 0},title:t?"Play":"Cannot play",children:a.jsx(u.Z,{card:e})},r)})}),a.jsx("h3",{style:{marginTop:24},children:"Scores"}),a.jsx("ul",{children:m.map((e,r)=>(0,a.jsxs)("li",{children:[e,": ",y[r]??0]},e))})]})}[l,o]=h.then?(await h)():h;let g=async e=>e.req.cookies?.auth_token?{props:{}}:{redirect:{destination:`/login?redirect=${encodeURIComponent(e.resolvedUrl)}`,permanent:!1}};s()}catch(e){s(e)}})},5021:(e,r,t)=>{t.d(r,{Z:()=>i});var s=t(997),a=t(6689);function i({card:e,isBackCard:r}){let t=(0,a.useMemo)(()=>{if(r)return"/cards/back.png";let t=e=>e.charAt(0)+e.slice(1).toLowerCase();return"NUMBERED"===e.type?`/cards/${t(e.color)}_${e.number}.jpg`:"WILD"===e.type?"/cards/Wild.jpg":"WILD DRAW"===e.type?"/cards/Wild_Draw_4.jpg":"SKIP"===e.type?`/cards/${t(e.color)}_Skip.jpg`:"DRAW"===e.type?`/cards/${t(e.color)}_Draw_2.jpg`:"REVERSE"===e.type?"RED"===e.color?"/cards/RED_Reverse.jpg":`/cards/${t(e.color)}_Reverse.jpg`:""},[e,r]);return s.jsx("img",{style:{height:230,display:"inline"},src:t})}},1902:(e,r,t)=>{t.d(r,{Z:()=>i});var s=t(997);t(6689);var a=t(5021);function i({type:e,card:r}){return"DRAW"===e?s.jsx(a.Z,{isBackCard:!0,card:{type:"WILD"}}):r?s.jsx(a.Z,{card:r}):null}},2785:e=>{e.exports=require("next/dist/compiled/next-server/pages.runtime.prod.js")},6689:e=>{e.exports=require("react")},6405:e=>{e.exports=require("react-dom")},997:e=>{e.exports=require("react/jsx-runtime")},2048:e=>{e.exports=require("fs")},5315:e=>{e.exports=require("path")},6162:e=>{e.exports=require("stream")},1568:e=>{e.exports=require("zlib")},3258:e=>{e.exports=import("@reduxjs/toolkit")},2024:e=>{e.exports=import("graphql-ws")},3291:e=>{e.exports=import("react-redux")},1395:e=>{e.exports=import("tslib")}};var r=require("../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[117,423,899,342,704],()=>t(9703));module.exports=s})();